# 91porn智能视频爬虫与推荐系统

基于MediaCMS构建的智能91porn视频爬虫和推荐系统，支持自动爬取、智能存储、双路召回推荐等功能。

## 🎯 项目特性

- ✅ **自动爬取**: 支持日榜、周榜、月榜前10视频自动爬取
- ✅ **智能存储**: 基于MD5去重，分类存储，智能管理
- ✅ **双路召回**: PostgreSQL关键词搜索 + Chroma语义向量搜索
- ✅ **响应式界面**: 支持手机、平板、桌面端访问
- ✅ **单服务器部署**: 优化的Docker部署方案

## 🏗️ 技术架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   React前端     │    │   Django后端    │    │   数据库层      │
│   (用户界面)    │◄──►│   (MediaCMS)    │◄──►│   PostgreSQL    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       │
    ┌─────────┐            ┌─────────┐            ┌─────────┐
    │ 静态资源 │            │ Celery  │            │ Redis   │
    │ (CSS/JS)│            │ (任务队列)│            │ (缓存)  │
    └─────────┘            └─────────┘            └─────────┘
         │                       │                       │
         │                       │                       │
    ┌─────────┐            ┌─────────┐            ┌─────────┐
    │ 视频存储 │            │ 爬虫服务 │            │ Chroma  │
    │ (本地)  │            │ (Selenium)│            │ (向量库)│
    └─────────┘            └─────────┘            └─────────┘
```

## 🚀 快速开始

### 环境要求

- Docker & Docker Compose
- 8GB+ 内存
- 50GB+ 存储空间

### 安装部署

1. **克隆项目**
```bash
git clone https://github.com/coyi1234567/91porn_spider.git
cd 91porn_spider
```

2. **启动服务**
```bash
cd mediacms
docker-compose up -d
```

3. **访问系统**
- 主页: http://localhost:80
- 管理后台: http://localhost:80/admin
- API文档: http://localhost:80/api/docs

### 配置说明

系统提供统一的配置页面，支持以下配置项：

- **爬虫设置**: 下载数量、同步频率、代理配置
- **存储管理**: 存储路径、去重策略、清理规则
- **推荐系统**: 向量模型、召回策略、融合算法
- **用户界面**: 主题设置、语言配置、权限管理

## 📁 项目结构

```
91porn_spider/
├── mediacms/                 # MediaCMS核心系统
│   ├── cms/                  # Django配置
│   ├── files/                # 媒体文件管理
│   ├── frontend/             # React前端
│   └── docker-compose.yaml   # Docker部署配置
├── crawler/                  # 爬虫服务
│   ├── spider91.py          # 主爬虫程序
│   ├── models.py            # 数据模型
│   └── utils.py             # 工具函数
├── config/                   # 配置文件
│   ├── settings.yaml        # 系统配置
│   └── proxy.yaml           # 代理配置
├── storage/                  # 存储管理
│   ├── video_storage/       # 视频文件存储
│   └── metadata/            # 元数据存储
├── docs/                     # 项目文档
│   ├── api.md               # API文档
│   ├── deployment.md        # 部署文档
│   ├── project_plan.md      # 详细项目计划
│   └── project_goals_and_tasks.md  # 项目目标与任务清单
└── scripts/                  # 脚本工具
    ├── setup.sh             # 安装脚本
    └── backup.sh            # 备份脚本
```

## 📋 项目进度

### 整体进度
- **已完成**: 1/7 阶段 (14.3%)
- **进行中**: 0/7 阶段 (0%)
- **待开始**: 6/7 阶段 (85.7%)

### 各阶段状态
- ✅ **第一阶段**: 基础架构搭建 (100% 完成)
- ❎ **第二阶段**: 数据库扩展和模型设计 (0% 完成)
- ❎ **第三阶段**: 爬虫系统集成 (0% 完成)
- ❎ **第四阶段**: AI推荐系统构建 (0% 完成)
- ❎ **第五阶段**: 前端界面定制 (0% 完成)
- ❎ **第六阶段**: 测试和优化 (0% 完成)
- ❎ **第七阶段**: 生产环境部署 (0% 完成)

**详细进度**: 查看 [项目目标与任务清单](docs/project_goals_and_tasks.md)

## 🔧 核心功能

### 1. 智能爬虫系统

- **多榜单支持**: 日榜、周榜、月榜自动爬取
- **智能去重**: 基于viewkey、标题相似度、MD5多重去重
- **元数据提取**: 标题、作者、热度、收藏、评分等完整信息
- **异步处理**: 基于Celery的异步任务队列

### 2. 双路召回推荐

- **关键词召回**: PostgreSQL全文搜索，支持中文分词
- **语义召回**: Chroma向量数据库，BGE中文向量模型
- **智能融合**: 基于用户行为的动态权重调整
- **实时推荐**: 毫秒级响应，支持个性化推荐

### 3. 智能存储管理

- **分类存储**: 按榜单类型、日期自动分类
- **去重机制**: 多层级去重策略，避免重复存储
- **空间管理**: 自动清理、压缩、备份机制
- **元数据管理**: 完整的视频元数据存储和检索

## 📊 性能指标

- **搜索响应**: < 500ms
- **推荐响应**: < 1s
- **并发支持**: 100+ 用户
- **存储效率**: 去重率 > 80%

## 🔒 安全特性

- **年龄验证**: 内置年龄验证机制
- **访问控制**: 基于角色的权限管理
- **数据加密**: 敏感数据加密存储
- **隐私保护**: 用户数据隐私保护

## 📈 监控与维护

- **系统监控**: 实时性能监控
- **日志管理**: 完整的操作日志
- **自动备份**: 定时数据备份
- **健康检查**: 服务健康状态监控

## 🤝 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建 Pull Request

## 📄 许可证

本项目基于 MIT 许可证开源。

## 🆘 支持与帮助

- 问题反馈: [GitHub Issues](https://github.com/coyi1234567/91porn_spider/issues)
- 文档: [项目文档](docs/)
- 社区: [讨论区](https://github.com/coyi1234567/91porn_spider/discussions)

---

**注意**: 本项目仅供学习和研究使用，请遵守相关法律法规。